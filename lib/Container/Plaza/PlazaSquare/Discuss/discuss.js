Object.defineProperty(exports,"__esModule",{value:true});var _jsxFileName='src/Container/Plaza/PlazaSquare/Discuss/discuss.js';var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _moment=require('moment');var _moment2=_interopRequireDefault(_moment);var _immutable=require('immutable');var _reactRedux=require('react-redux');var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _reactImmutableProptypes=require('react-immutable-proptypes');var _reactImmutableProptypes2=_interopRequireDefault(_reactImmutableProptypes);var _reactNativeAnimatable=require('react-native-animatable');var Animatable=_interopRequireWildcard(_reactNativeAnimatable);var _dialogFrame=require('./DialogFrame/dialogFrame');var _dialogFrame2=_interopRequireDefault(_dialogFrame);var _generateSize=require('../../../../Action/generateSize');var _generateSize2=_interopRequireDefault(_generateSize);var _generateColor=require('../../../../Action/generateColor');var _generateColor2=_interopRequireDefault(_generateColor);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _Dimensions$get=_reactNative.Dimensions.get('window'),height=_Dimensions$get.height,width=_Dimensions$get.width;var Discuss=function Discuss(_ref){var userInfo=_ref.userInfo,plazaName=_ref.plazaName,speechId=_ref.speechId,replyToUserName=_ref.replyToUserName,articalUserName=_ref.articalUserName,placeholder=_ref.placeholder,text=_ref.text,visibility=_ref.visibility,discuss=_ref.discuss,light=_ref.light,fontSize=_ref.fontSize,discussVisibility=_ref.discussVisibility,textChange=_ref.textChange,comfirm=_ref.comfirm;return _react2.default.createElement(_reactNative.KeyboardAvoidingView,{behavior:'position',keyboardVerticalOffset:_reactNative.Platform.OS==='ios'?50:-500,__source:{fileName:_jsxFileName,lineNumber:26}},_react2.default.createElement(_reactNative.View,{style:[styles.main,{backgroundColor:'#'+(0,_generateColor2.default)(50,109,light)}],__source:{fileName:_jsxFileName,lineNumber:27}},_react2.default.createElement(_reactNative.ScrollView,{showsVerticalScrollIndicator:false,__source:{fileName:_jsxFileName,lineNumber:28}},_react2.default.createElement(_reactNative.Text,{style:[styles.content_text,{color:'#'+(0,_generateColor2.default)(166,216,light),fontSize:(0,_generateSize2.default)(fontSize,20)}],__source:{fileName:_jsxFileName,lineNumber:29}},text))),_react2.default.createElement(_reactNative.View,{__source:{fileName:_jsxFileName,lineNumber:32}},_react2.default.createElement(_dialogFrame2.default,{discuss:discuss,articalUserName:articalUserName,__source:{fileName:_jsxFileName,lineNumber:33}}),_react2.default.createElement(_reactNative.View,{style:styles.review,__source:{fileName:_jsxFileName,lineNumber:34}},_react2.default.createElement(_reactNative.TouchableOpacity,{onPress:discussVisibility({visibility:!visibility}),__source:{fileName:_jsxFileName,lineNumber:35}},_react2.default.createElement(_reactNative.View,{style:styles.comfirmContainer,__source:{fileName:_jsxFileName,lineNumber:36}},_react2.default.createElement(Animatable.Text,{transition:'rotateX',style:[styles.comfirm,{transform:[{rotateX:visibility?'180deg':'0deg'}]}],__source:{fileName:_jsxFileName,lineNumber:37}},'\uFE40'))),_react2.default.createElement(_reactNative.TextInput,{onFocus:discussVisibility({visibility:true}),placeholder:placeholder,value:discuss.getIn(['location','text']),style:styles.textInput,onChangeText:function onChangeText(value){return textChange({value:value});},__source:{fileName:_jsxFileName,lineNumber:40}}),_react2.default.createElement(_reactNative.TouchableHighlight,{onPress:comfirm({userInfo:userInfo,text:discuss.getIn(['location','text']),sourceDetail:(0,_immutable.Map)({userName:replyToUserName,text:discuss.getIn(['location','text']),time:(0,_moment2.default)().format('YYYY-MM-DD hh:mm'),location:(0,_immutable.Map)({plazaName:plazaName,speechId:speechId})})}),__source:{fileName:_jsxFileName,lineNumber:41}},_react2.default.createElement(_reactNative.View,{style:styles.comfirmContainer,__source:{fileName:_jsxFileName,lineNumber:51}},_react2.default.createElement(_reactNative.Text,{style:styles.comfirm,__source:{fileName:_jsxFileName,lineNumber:52}},' \u53D1\u9001 '))))));};Discuss.propTypes={plazaName:_propTypes2.default.string.isRequired,speechId:_propTypes2.default.string.isRequired,replyToUserName:_propTypes2.default.string.isRequired,placeholder:_propTypes2.default.string.isRequired,userInfo:_reactImmutableProptypes2.default.map.isRequired,text:_propTypes2.default.string.isRequired,visibility:_propTypes2.default.bool.isRequired,discuss:_reactImmutableProptypes2.default.map.isRequired,articalUserName:_propTypes2.default.string.isRequired,light:_propTypes2.default.number.isRequired,fontSize:_propTypes2.default.string.isRequired,discussVisibility:_propTypes2.default.func.isRequired,textChange:_propTypes2.default.func.isRequired,comfirm:_propTypes2.default.func.isRequired};var styles=_reactNative.StyleSheet.create({main:{width:width,height:height*0.835,alignItems:'center',paddingTop:20,zIndex:-10},content_text:{width:width*0.9,color:'white',fontSize:20,lineHeight:30},discuss:{borderTopWidth:1,borderStyle:'solid',width:width,backgroundColor:'#ededed',flexDirection:'row'},review:{width:width,height:height*0.09,flexDirection:'row',justifyContent:'space-around',alignItems:'center',shadowColor:'#333',backgroundColor:'#f9f9f9',shadowOffset:{width:2,height:-2},shadowOpacity:0.7},textInput:{width:width*0.7,height:height*0.06,backgroundColor:'#ededed',color:'#6a6a6a'},comfirmContainer:{width:width*0.1,height:height*0.06,backgroundColor:'#ededed',alignItems:'center',justifyContent:'center'},comfirm:{fontSize:15,color:'#6a6a6a'}});var mapStateToProps=function mapStateToProps(state){var plazaName=state.getIn(['plaza','plazaName']);var speechId=state.getIn(['plaza',plazaName,'speechId']);var content=state.getIn(['plaza',plazaName,'content',speechId]);var location=content.getIn(['discuss','location']);var userInfo=state.getIn(['me','我的信息']);var replyToUserName=location.get('discussId')===''?content.get('userName'):content.getIn(['discuss','content',location.get('time'),location.get('discussId'),'userName']);return{userInfo:userInfo,plazaName:plazaName,speechId:speechId,replyToUserName:replyToUserName,text:content.get('text'),articalUserName:content.get('userName'),visibility:content.getIn(['discuss','visibility']),placeholder:location.get('discussId')===''||userInfo.get('userName')===replyToUserName?'':'\u5BF9'+replyToUserName+'\u7684\u56DE\u590D',discuss:content.get('discuss'),light:state.getIn(['pageSet','light']),fontSize:state.getIn(['pageSet','fontSize'])};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{comfirm:function comfirm(_ref2){var userInfo=_ref2.userInfo,text=_ref2.text,sourceDetail=_ref2.sourceDetail;return function(){if(text.trim().length>0){dispatch({type:'PLAZA_DICUSS_COMFIRM',userInfo:userInfo});dispatch({type:'ME_ADD',viewMode:'我的回复',sourceDetail:sourceDetail});}};},textChange:function textChange(_ref3){var value=_ref3.value;return dispatch({type:'PLAZA_DISCUSS_CHANGE_TEXT',text:value});},discussVisibility:function discussVisibility(_ref4){var visibility=_ref4.visibility;return function(){return dispatch({type:'PLAZA_CHANGE_DISCUSS_VISIBILITY',visibility:visibility});};}};};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Discuss);