Object.defineProperty(exports,"__esModule",{value:true});var _toast=require('antd-mobile/lib/toast');var _toast2=_interopRequireDefault(_toast);var _modal=require('antd-mobile/lib/modal');var _modal2=_interopRequireDefault(_modal);var _jsxFileName='src/Container/Plaza/PlazaSquare/piece.js';var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _reactRedux=require('react-redux');var _immutable=require('immutable');var _moment=require('moment');var _moment2=_interopRequireDefault(_moment);var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _reactImmutableProptypes=require('react-immutable-proptypes');var _reactImmutableProptypes2=_interopRequireDefault(_reactImmutableProptypes);var _reactNativeSwipeout=require('react-native-swipeout');var _reactNativeSwipeout2=_interopRequireDefault(_reactNativeSwipeout);var _generateColor=require('../../../Action/generateColor');var _generateColor2=_interopRequireDefault(_generateColor);var _generateSize=require('../../../Action/generateSize');var _generateSize2=_interopRequireDefault(_generateSize);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _Dimensions$get=_reactNative.Dimensions.get('window'),width=_Dimensions$get.width;var alert=_modal2.default.alert;var Piece=function Piece(_ref){var speechTitle=_ref.speechTitle,userName=_ref.userName,plazaName=_ref.plazaName,speechId=_ref.speechId,imageSource=_ref.imageSource,content=_ref.content,light=_ref.light,fontSize=_ref.fontSize,share=_ref.share,collect=_ref.collect,deleteContent=_ref.deleteContent,onPress=_ref.onPress;var swipeBtns=[{text:'转发',backgroundColor:'#aaa',color:'#6a6a6a',onPress:share({sourceDetail:(0,_immutable.Map)({text:'',time:(0,_moment2.default)().format('YYYY-MM-DD hh:mm'),location:(0,_immutable.Map)({plazaName:plazaName,speechId:speechId})})})},{text:'收藏',backgroundColor:'#aaa',color:'#6a6a6a',onPress:collect({sourceDetail:(0,_immutable.Map)({userName:userName,speechTitle:speechTitle,time:(0,_moment2.default)().format('YYYY-MM-DD'),location:(0,_immutable.Map)({plazaName:plazaName,speechId:speechId})})})},{text:'删除',backgroundColor:'#aaa',color:'#6a6a6a',onPress:deleteContent}];return _react2.default.createElement(_reactNativeSwipeout2.default,{right:swipeBtns,backgroundColor:'transparent',style:{marginTop:20},autoClose:true,__source:{fileName:_jsxFileName,lineNumber:63}},_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:onPress,__source:{fileName:_jsxFileName,lineNumber:64}},_react2.default.createElement(_reactNative.View,{style:styles.main,__source:{fileName:_jsxFileName,lineNumber:65}},_react2.default.createElement(_reactNative.View,{style:[styles.img,{backgroundColor:'#'+(0,_generateColor2.default)(120,170,light)}],__source:{fileName:_jsxFileName,lineNumber:66}},_react2.default.createElement(_reactNative.Image,{style:{width:30,height:40},source:imageSource,__source:{fileName:_jsxFileName,lineNumber:67}})),_react2.default.createElement(_reactNative.View,{style:[styles.content,{backgroundColor:'#'+(0,_generateColor2.default)(166,216,light)}],__source:{fileName:_jsxFileName,lineNumber:69}},_react2.default.createElement(_reactNative.View,{style:styles.textTop,__source:{fileName:_jsxFileName,lineNumber:70}},_react2.default.createElement(_reactNative.Text,{style:{fontSize:12,color:'#6a6a6a'},__source:{fileName:_jsxFileName,lineNumber:71}},content.get('userName'))),_react2.default.createElement(_reactNative.View,{style:styles.contentName,__source:{fileName:_jsxFileName,lineNumber:73}},_react2.default.createElement(_reactNative.Text,{style:{fontWeight:'bold',color:'#'+(0,_generateColor2.default)(50,109,light),fontSize:(0,_generateSize2.default)(fontSize,16)},__source:{fileName:_jsxFileName,lineNumber:74}},content.get('title')))))));};Piece.propTypes={speechTitle:_propTypes2.default.string.isRequired,userName:_propTypes2.default.string.isRequired,plazaName:_propTypes2.default.string.isRequired,speechId:_propTypes2.default.string.isRequired,imageSource:_propTypes2.default.number.isRequired,content:_reactImmutableProptypes2.default.map.isRequired,light:_propTypes2.default.number.isRequired,fontSize:_propTypes2.default.string.isRequired,share:_propTypes2.default.func.isRequired,collect:_propTypes2.default.func.isRequired,deleteContent:_propTypes2.default.func.isRequired,onPress:_propTypes2.default.func.isRequired};var styles=_reactNative.StyleSheet.create({main:{width:width*0.9,height:70,flexDirection:'row'},img:{width:90,height:70,alignItems:'center',justifyContent:'center'},content:{width:width*0.9-90,height:70},contentName:{height:50,justifyContent:'center',alignItems:'center'},textTop:{height:15,marginLeft:5,marginRight:5,marginTop:5,flexDirection:'row',justifyContent:'space-between'}});var mapStateToProps=function mapStateToProps(state,ownProps){return{plazaName:state.getIn(['plaza','plazaName']),imageSource:ownProps.content.get('gender')==='male'?require('../../../Image/Menu/maleGrey.png'):require('../../../Image/Menu/femaleGrey.png'),userName:state.getIn(['plaza',state.getIn(['plaza','plazaName']),'content',ownProps.speechId,'userName']),speechTitle:state.getIn(['plaza',state.getIn(['plaza','plazaName']),'content',ownProps.speechId,'title']),light:state.getIn(['pageSet','light']),fontSize:state.getIn(['pageSet','fontSize'])};};var mapDispatchToProps=function mapDispatchToProps(dispatch,ownProps){return{onPress:function onPress(){dispatch({type:'SPEECH_DISCUSS',speechId:ownProps.speechId});},deleteContent:function deleteContent(){alert('删除这条消息','',[{text:'取消',onPress:function onPress(){return console.log('cancel');}},{text:'确定',onPress:function onPress(){dispatch({type:'PLAZA_SPEECH_DELETE',speechId:ownProps.speechId});}}]);},collect:function collect(_ref2){var sourceDetail=_ref2.sourceDetail;return function(){_toast2.default.success('收藏成功!',1);dispatch({type:'ME_ADD',viewMode:'我的收藏',sourceDetail:sourceDetail});};},share:function share(_ref3){var sourceDetail=_ref3.sourceDetail;return function(){dispatch({type:'OPERATION_2_SHARE',source:'plaza',sourceDetail:sourceDetail});dispatch({type:'PLAZA_SHARE_PRESS',viewMode:'share'});};}};};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Piece);