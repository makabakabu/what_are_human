Object.defineProperty(exports,"__esModule",{value:true});var _toast=require('antd-mobile/lib/toast');var _toast2=_interopRequireDefault(_toast);var _jsxFileName='src/Component/Content/OperationPanel/Operation/share.js',_this=this;var _templateObject=_taggedTemplateLiteral(['\n    mutation academyShare ($token: String!, $text: String!, $order: Int!) {\n        academyShare (token: $token, text: $text, order: $order) {\n            finish\n        }\n    }\n'],['\n    mutation academyShare ($token: String!, $text: String!, $order: Int!) {\n        academyShare (token: $token, text: $text, order: $order) {\n            finish\n        }\n    }\n']);var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _reactRedux=require('react-redux');var _graphqlTag=require('graphql-tag');var _graphqlTag2=_interopRequireDefault(_graphqlTag);var _reactApollo=require('react-apollo');var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _reactImmutableProptypes=require('react-immutable-proptypes');var _reactImmutableProptypes2=_interopRequireDefault(_reactImmutableProptypes);var _generateColor=require('../../../../Action/generateColor');var _generateColor2=_interopRequireDefault(_generateColor);var _generateSize=require('../../../../Action/generateSize');var _generateSize2=_interopRequireDefault(_generateSize);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}var academyShare=(0,_graphqlTag2.default)(_templateObject);var _Dimensions$get=_reactNative.Dimensions.get('window'),height=_Dimensions$get.height,width=_Dimensions$get.width;var Share=function Share(_ref){var share=_ref.share,token=_ref.token,academyShare=_ref.academyShare,content=_ref.content,text=_ref.text,light=_ref.light,fontSize=_ref.fontSize,changeText=_ref.changeText,changeTextComfirm=_ref.changeTextComfirm;return _react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:_reactNative.Keyboard.dismiss,__source:{fileName:_jsxFileName,lineNumber:31}},_react2.default.createElement(_reactNative.View,{style:[styles.main,{backgroundColor:'#'+(0,_generateColor2.default)(50,109,light)}],__source:{fileName:_jsxFileName,lineNumber:32}},_react2.default.createElement(_reactNative.View,{style:{width:width*0.9,height:30,flexDirection:'row',justifyContent:'space-between',marginTop:10},__source:{fileName:_jsxFileName,lineNumber:33}},_react2.default.createElement(_reactNative.TouchableOpacity,{onPress:changeTextComfirm({kind:'cancel'}),__source:{fileName:_jsxFileName,lineNumber:34}},_react2.default.createElement(_reactNative.View,{style:{height:30,width:50,backgroundColor:'#aaa',justifyContent:'center',alignItems:'center'},__source:{fileName:_jsxFileName,lineNumber:35}},_react2.default.createElement(_reactNative.Text,{style:{color:'#ededed',fontSize:14},__source:{fileName:_jsxFileName,lineNumber:36}},'\u53D6\u6D88'))),_react2.default.createElement(_reactNative.TouchableOpacity,{onPress:changeTextComfirm({kind:'complete',academyShare:academyShare,share:share,token:token}),__source:{fileName:_jsxFileName,lineNumber:41}},_react2.default.createElement(_reactNative.View,{style:{height:30,width:50,backgroundColor:'#aaa',justifyContent:'center',alignItems:'center'},__source:{fileName:_jsxFileName,lineNumber:42}},_react2.default.createElement(_reactNative.Text,{style:{color:'#ededed',fontSize:14},__source:{fileName:_jsxFileName,lineNumber:43}},'\u5B8C\u6210')))),_react2.default.createElement(_reactNative.TextInput,{style:[styles.editor,{fontSize:(0,_generateSize2.default)(fontSize,20),color:'#'+(0,_generateColor2.default)(166,216,light)}],value:text,onChangeText:function onChangeText(value){return changeText({value:value});},placeholderTextColor:'#a6a6a6',placeholder:'\u5728\u6B64\u8F93\u5165\u4F60\u7684\u8F6C\u53D1\u8BC4\u8BBA',editable:true,multiline:true,__source:{fileName:_jsxFileName,lineNumber:49}}),_react2.default.createElement(_reactNative.View,{style:{flexDirection:'row',marginTop:30},__source:{fileName:_jsxFileName,lineNumber:50}},_react2.default.createElement(_reactNative.View,{style:{width:0.3*width,height:0.16*height,alignItems:'center',justifyContent:'center',backgroundColor:'#a6a6a6'},__source:{fileName:_jsxFileName,lineNumber:51}},_react2.default.createElement(_reactNative.Image,{style:{height:60,width:80},source:require('../../../../Image/Logo.png'),__source:{fileName:_jsxFileName,lineNumber:52}})),_react2.default.createElement(_reactNative.View,{style:{width:0.6*width,height:0.16*height,alignItems:'center',justifyContent:'center',backgroundColor:'#d8d8d8'},__source:{fileName:_jsxFileName,lineNumber:54}},_react2.default.createElement(_reactNative.Text,{style:{color:'#606060',fontSize:16},__source:{fileName:_jsxFileName,lineNumber:55}},content.substr(0,20)+'...')))));};Share.propTypes={content:_propTypes2.default.string.isRequired,text:_propTypes2.default.string.isRequired,light:_propTypes2.default.number.isRequired,fontSize:_propTypes2.default.string.isRequired,changeText:_propTypes2.default.func.isRequired,changeTextComfirm:_propTypes2.default.func.isRequired,share:_reactImmutableProptypes2.default.map.isRequired,token:_propTypes2.default.string.isRequired};var styles=_reactNative.StyleSheet.create({main:{width:'100%',height:height*0.835,backgroundColor:'#6d6d6d',zIndex:-10,alignItems:'center'},editor:{width:width*0.9,height:120,color:'white',marginTop:30,lineHeight:30}});var mapStateToProps=function mapStateToProps(state){var text='';var content='';switch(state.getIn(['share','source'])){case'academy':{var academy=state.getIn(['share','academy']);text=academy.get('text');content=state.getIn(['academy','content',academy.getIn(['location','order']),'text']);break;}case'notes':{var notes=state.getIn(['share','notes']);text=notes.get('text');content=state.getIn(['notes',notes.getIn(['location','viewMode']),'notes',notes.getIn(['location','notesId']),'text']);break;}case'plaza':{var plaza=state.getIn(['share','plaza']);text=plaza.get('text');content=state.getIn(['plaza',plaza.getIn(['location','plazaName']),'content',plaza.getIn(['location','speechId']),'text']);break;}default:break;}return{text:text,content:content,share:state.get('share'),light:state.getIn(['pageSet','light']),fontSize:state.getIn(['pageSet','fontSize']),token:state.getIn(['me','我的信息','token'])};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{changeText:function changeText(_ref2){var value=_ref2.value;return dispatch({type:'SHARE_CHANGE_TEXT',value:value});},changeTextComfirm:function changeTextComfirm(_ref3){var kind=_ref3.kind,academyShare=_ref3.academyShare,share=_ref3.share,token=_ref3.token;return function _callee(){var response,finish;return regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(kind==='complete')){_context.next=11;break;}_context.t0=share.get('source');_context.next=_context.t0==='academy'?4:10;break;case 4:_context.next=6;return regeneratorRuntime.awrap(academyShare({variables:{token:token,order:share.getIn(['academy','location','order']),text:share.getIn(['academy','text'])}}));case 6:response=_context.sent;finish=response.data.academyShare.finish;if(finish){_toast2.default.success('转发成功！');}else{_toast2.default.fail('转发失败！请检查您的网络！');}return _context.abrupt('break',11);case 10:return _context.abrupt('break',11);case 11:dispatch({type:'SHARE_CHANGE_TEXT',value:''});dispatch({type:'BACK'});case 13:case'end':return _context.stop();}}},null,_this);};}};};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)((0,_reactApollo.graphql)(academyShare,{name:'academyShare'})(Share));