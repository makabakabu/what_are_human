Object.defineProperty(exports,"__esModule",{value:true});var _jsxFileName='src/Component/Content/OperationPanel/Operation/Comment/comment.js',_this=this;var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _reactRedux=require('react-redux');var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _reactImmutableProptypes=require('react-immutable-proptypes');var _reactImmutableProptypes2=_interopRequireDefault(_reactImmutableProptypes);var _commentContainer=require('./commentContainer');var _commentContainer2=_interopRequireDefault(_commentContainer);var _generateSize=require('../../../../../Action/generateSize');var _generateSize2=_interopRequireDefault(_generateSize);var _generateColor=require('../../../../../Action/generateColor');var _generateColor2=_interopRequireDefault(_generateColor);var _operationPanel=require('../../operationPanel');var _operationPanel2=_interopRequireDefault(_operationPanel);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _Dimensions$get=_reactNative.Dimensions.get('window'),height=_Dimensions$get.height,width=_Dimensions$get.width;var Comment=function Comment(_ref){var light=_ref.light,fontSize=_ref.fontSize,text=_ref.text,commentText=_ref.commentText,order=_ref.order,reply=_ref.reply,content=_ref.content,textChange=_ref.textChange,comfirm=_ref.comfirm;return _react2.default.createElement(_reactNative.KeyboardAvoidingView,{behavior:'position',keyboardVerticalOffset:_reactNative.Platform.OS==='ios'?50:-500,__source:{fileName:_jsxFileName,lineNumber:24}},_react2.default.createElement(_reactNative.View,{style:[styles.main,{backgroundColor:'#'+(0,_generateColor2.default)(50,109,light)}],__source:{fileName:_jsxFileName,lineNumber:25}},_react2.default.createElement(_reactNative.ScrollView,{showsVerticalScrollIndicator:false,__source:{fileName:_jsxFileName,lineNumber:26}},_react2.default.createElement(_reactNative.Text,{style:[styles.text,{fontSize:(0,_generateSize2.default)(fontSize,20),color:'#'+(0,_generateColor2.default)(166,216,light)}],__source:{fileName:_jsxFileName,lineNumber:27}},text),_react2.default.createElement(_operationPanel2.default,{order:order,__source:{fileName:_jsxFileName,lineNumber:30}}),_react2.default.createElement(_reactNative.FlatList,{data:content.map(function(value,key){return{key:key,value:value};}).valueSeq().toArray(),renderItem:function renderItem(_ref2){var item=_ref2.item;return _react2.default.createElement(_commentContainer2.default,{key:item.key,content:item.value,commentId:item.key,__source:{fileName:_jsxFileName,lineNumber:33}});},__source:{fileName:_jsxFileName,lineNumber:31}}),_react2.default.createElement(_reactNative.View,{style:{height:10},__source:{fileName:_jsxFileName,lineNumber:35}}))),_react2.default.createElement(_reactNative.View,{style:styles.comment,__source:{fileName:_jsxFileName,lineNumber:38}},_react2.default.createElement(_reactNative.TextInput,{style:styles.textInput,placeholder:reply,value:commentText,onChangeText:function onChangeText(value){return textChange({value:value});},__source:{fileName:_jsxFileName,lineNumber:39}}),_react2.default.createElement(_reactNative.TouchableHighlight,{onPress:comfirm({commentText:commentText}),__source:{fileName:_jsxFileName,lineNumber:40}},_react2.default.createElement(_reactNative.View,{style:styles.comfirmContainer,__source:{fileName:_jsxFileName,lineNumber:41}},_react2.default.createElement(_reactNative.Text,{style:styles.comfirm,__source:{fileName:_jsxFileName,lineNumber:42}},' \u53D1\u9001 ')))));};Comment.propTypes={light:_propTypes2.default.number.isRequired,fontSize:_propTypes2.default.string.isRequired,text:_propTypes2.default.string.isRequired,commentText:_propTypes2.default.string.isRequired,order:_propTypes2.default.string.isRequired,content:_reactImmutableProptypes2.default.map.isRequired,reply:_propTypes2.default.string.isRequired,textChange:_propTypes2.default.func.isRequired,comfirm:_propTypes2.default.func.isRequired};var styles=_reactNative.StyleSheet.create({main:{width:width,height:height*0.835,backgroundColor:'#6d6d6d',zIndex:-10,alignItems:'center'},text:{width:width*0.9,fontSize:20,color:'white',marginTop:30,lineHeight:30},comment:{width:width,height:height*0.09,flexDirection:'row',justifyContent:'center',alignItems:'center',shadowColor:'#333',backgroundColor:'#f9f9f9',shadowOffset:{width:2,height:-2},shadowOpacity:0.7},textInput:{width:width*0.8,height:height*0.06,backgroundColor:'#ededed'},comfirmContainer:{width:width*0.15,height:height*0.06,backgroundColor:'#ededed',marginLeft:5,alignItems:'center',justifyContent:'center'},comfirm:{fontSize:15,color:'#6a6a6a'}});var mapStateToProps=function mapStateToProps(state){var comment=state.getIn(['academy','content',state.getIn(['academy','order']),'operation','comment']);var location=comment.get('location');var order=state.getIn(['academy','order']);var reply='';if(location.get('viewMode')==='comment'){reply='\u5BF9'+comment.getIn(['content',location.get('commentId'),'userName'])+'\u7684\u8BC4\u8BBA';}else if(comment.getIn(['location','viewMode'])==='recomment'&&comment.getIn(['content',location.get('commentId'),'recomment',location.get('recommentId'),'userName'])!==comment.getIn(['content',location.get('commentId'),'userName'])){reply='\u5BF9'+comment.getIn(['content',location.get('commentId'),'recomment',location.get('recommentId'),'userName'])+'\u7684\u8BC4\u8BBA';}return{content:comment.get('content'),order:order,text:state.getIn(['academy','content',order,'text']),reply:reply,commentText:location.get('text'),light:state.getIn(['pageSet','light']),fontSize:state.getIn(['pageSet','fontSize'])};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{comfirm:function comfirm(_ref3){var commentText=_ref3.commentText;return function _callee(){return regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(commentText.trim().length>0)){_context.next=4;break;}_context.next=3;return regeneratorRuntime.awrap(new Promise(function(resolve){dispatch({type:'ACADEMY_COMMENT_COMFIRM'});setTimeout(function(){return resolve(true);},1000);}));case 3:dispatch({type:'ME_ADD',viewMode:'我的评论'});case 4:case'end':return _context.stop();}}},null,_this);};},textChange:function textChange(_ref4){var value=_ref4.value;return dispatch({type:'ACADEMY_COMMENT_TEXTCHANGE',value:value});}};};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Comment);